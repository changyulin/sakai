function Trim(a){for(;" "==a.substring(0,1)||"\n"==a.substring(0,1)||"\r"==a.substring(0,1);)a=a.substring(1,a.length);for(;" "==a.substring(a.length-1,a.length)||"\n"==a.substring(a.length-1,a.length)||"\r"==a.substring(a.length-1,a.length);)a=a.substring(0,a.length-1);return a}function submitenter(a){var b;if(window.event)b=window.event.keyCode;else{if(!a)return!0;b=a.which}return 13==b?(calcScore(),!1):!0}function convertCase(){var a=document.examForm.Q1.value;return""!=a&&(a=Trim(a.toLowerCase())),a}function calcRawScore(){for(rawScore=0,i=0;i<key.length;i++)if(convertCase()==Trim(key[i].toLowerCase())){rawScore++;break}}function calcScore(){document.examForm.submitButton.disabled=!0,calcRawScore(),doSetValue("cmi.score.scaled",rawScore),1!=rawScore?(doSetValue("cmi.success_status","failed"),showDiv("incorrect")):(doSetValue("cmi.success_status","passed"),showDiv("correct")),doSetValue("cmi.completion_status","completed"),doSetValue("cmi.exit",""),exitPageStatus=!0}function pretestShowDiv(a){if(!document.getElementsByTagName)return null;for(var b=document.getElementsByTagName("div"),c=0;c<b.length;c++){var d=b[c],e=d.id;"assess"==e.substring(0,6)&&(d.style.display="none"),e==a&&(d.style.display="block")}}function pretestBtnAction(a,b){if("prev"==b){if(1==prevId)return Previous(),void 0;prevId--,nextId--,pretestShowDiv("assess"+prevId)}else prevId++,nextId++,pretestShowDiv("assess"+nextId);document.getElementById("prevBtn").style.visibility="visible",document.getElementById("nextBtn").style.visibility="visible",document.getElementById("submitBtn").style.visibility="hidden",1==prevId&&(document.getElementById("prevBtn").style.visibility=RenderPreviousButton()?"visible":"hidden"),nextId==document.getElementById("content").getElementsByTagName("div").length&&(document.getElementById("nextBtn").style.visibility="hidden",document.getElementById("submitBtn").style.visibility="visible")}function pretestCalcRawScore(){for(rawScore1=0,rawScore2=0,rawScore3=0,i=0;i<key.length;i++){if(compareAnswer="unanswered","0"==i)compareAnswer=document.examForm.Q1.value;else if("1"==i)for(var a=0;a<document.examForm.Q2.length;a++)document.examForm.Q2[a].checked&&(compareAnswer=document.examForm.Q2[a].value);else if("2"==i)for(var a=0;a<document.examForm.Q3.length;a++)document.examForm.Q3[a].checked&&(compareAnswer=document.examForm.Q3[a].value);else if("3"==i)for(var a=0;a<document.examForm.Q4.length;a++)document.examForm.Q4[a].checked&&(compareAnswer=document.examForm.Q4[a].value);else if("4"==i)for(var a=0;a<document.examForm.Q5.length;a++)document.examForm.Q5[a].checked&&(compareAnswer=document.examForm.Q5[a].value);else if("5"==i)compareAnswer=document.examForm.Q6.value;else if("6"==i)compareAnswer=document.examForm.Q7.value;else if("7"==i)compareAnswer=document.examForm.Q8.value;else if("8"==i)for(var a=0;a<document.examForm.Q9.length;a++)document.examForm.Q9[a].checked&&(compareAnswer=document.examForm.Q9[a].value);else if("9"==i)compareAnswer=document.examForm.Q10.value;else if("10"==i)compareAnswer=document.examForm.Q11.value;else if("11"==i)compareAnswer=document.examForm.Q12.value;else if("12"==i)compareAnswer=document.examForm.Q13.value;else if("13"==i)compareAnswer=document.examForm.Q14.value;else if("14"==i)compareAnswer=document.examForm.Q15.value;else if("15"==i)compareAnswer=document.examForm.Q16.value;else if("16"==i)for(var a=0;a<document.examForm.Q17.length;a++)document.examForm.Q17[a].checked&&(compareAnswer=document.examForm.Q17[a].value);else if("17"==i)for(var a=0;a<document.examForm.Q18.length;a++)document.examForm.Q18[a].checked&&(compareAnswer=document.examForm.Q18[a].value);else if("18"==i)for(var a=0;a<document.examForm.Q19.length;a++)document.examForm.Q19[a].checked&&(compareAnswer=document.examForm.Q19[a].value);else if("19"==i)for(var a=0;a<document.examForm.Q20.length;a++)document.examForm.Q20[a].checked&&(compareAnswer=document.examForm.Q20[a].value);else if("20"==i)compareAnswer=document.examForm.Q21.value;else if("21"==i)for(var a=0;a<document.examForm.Q22.length;a++)document.examForm.Q22[a].checked&&(compareAnswer=document.examForm.Q22[a].value);else if("22"==i)for(var a=0;a<document.examForm.Q23.length;a++)document.examForm.Q23[a].checked&&(compareAnswer=document.examForm.Q23[a].value);else if("23"==i)for(var a=0;a<document.examForm.Q24.length;a++)document.examForm.Q24[a].checked&&(compareAnswer=document.examForm.Q24[a].value);else if("24"==i)for(var a=0;a<document.examForm.Q25.length;a++)document.examForm.Q25[a].checked&&(compareAnswer=document.examForm.Q25[a].value);else if("25"==i)for(var a=0;a<document.examForm.Q26.length;a++)document.examForm.Q26[a].checked&&(compareAnswer=document.examForm.Q26[a].value);else if("26"==i)for(var a=0;a<document.examForm.Q27.length;a++)document.examForm.Q27[a].checked&&(compareAnswer=document.examForm.Q27[a].value);else if("27"==i)for(var a=0;a<document.examForm.Q28.length;a++)document.examForm.Q28[a].checked&&(compareAnswer=document.examForm.Q28[a].value);else if("28"==i)for(var a=0;a<document.examForm.Q29.length;a++)document.examForm.Q29[a].checked&&(compareAnswer=document.examForm.Q29[a].value);else if("29"==i)for(var a=0;a<document.examForm.Q30.length;a++)document.examForm.Q30[a].checked&&(compareAnswer=document.examForm.Q30[a].value);else if("30"==i)for(var a=0;a<document.examForm.Q31.length;a++)document.examForm.Q31[a].checked&&(compareAnswer=document.examForm.Q31[a].value);else if("31"==i)for(var a=0;a<document.examForm.Q32.length;a++)document.examForm.Q32[a].checked&&(compareAnswer=document.examForm.Q32[a].value);else if("32"==i)for(var a=0;a<document.examForm.Q33.length;a++)document.examForm.Q33[a].checked&&(compareAnswer=document.examForm.Q33[a].value);else if("33"==i)for(var a=0;a<document.examForm.Q34.length;a++)document.examForm.Q34[a].checked&&(compareAnswer=document.examForm.Q34[a].value);else if("34"==i)for(var a=0;a<document.examForm.Q35.length;a++)document.examForm.Q35[a].checked&&(compareAnswer=document.examForm.Q35[a].value);if(compareAnswer=Trim(compareAnswer.toLowerCase()),"object"==typeof key[i])for(a=0;a<key[i].length;a++)compareKey=Trim(key[i][a].toLowerCase()),alert(compareAnswer),alert(compareKey),compareAnswer==compareKey&&(3>=i&&rawScore1++,i>3&&23>=i&&rawScore2++,i>23&&33>=i&&rawScore3++);else compareKey=Trim(key[i].toLowerCase()),alert(compareAnswer),alert(compareKey),compareAnswer==compareKey&&(3>=i&&rawScore1++,i>3&&23>=i&&rawScore2++,i>23&&33>=i&&rawScore3++)}}function pretestCalcScore(){document.examForm.submitBtn.disabled=!0,pretestCalcRawScore();var a=doGetValue("cmi.objectives._count");for(i=0;a>i;i++){var b=doGetValue("cmi.objectives."+i+".id");if("obj_module_1"==b)var c="cmi.objectives."+i;else if("obj_module_2"==b)var d="cmi.objectives."+i;else if("obj_module_3"==b)var e="cmi.objectives."+i}var f=Math.round(100*(rawScore1/3))/100;f>=1&&(f=1),doSetValue(c+".score.scaled",String(f)),rawScore1>=3?doSetValue(c+".success_status","passed"):doSetValue(c+".success_status","failed");var g=Math.round(100*(rawScore2/15))/100;g>=1&&(g=1),doSetValue(d+".score.scaled",String(g)),rawScore2>=15?doSetValue(d+".success_status","passed"):doSetValue(d+".success_status","failed");var h=Math.round(100*(rawScore3/8))/100;h>=1&&(h=1),doSetValue(e+".score.scaled",String(h)),rawScore3>=8?doSetValue(e+".success_status","passed"):doSetValue(e+".success_status","failed"),doSetValue("cmi.completion_status","completed"),doSetValue("cmi.exit",""),exitPageStatus=!0,IntraNavigation=!0,doSetValue("adl.nav.request","continue"),doTerminate()}function loadPage(){Initialize(),SetContinue(),exitPageStatus=!1,showDiv("question")}function doQuit(){calcScore()}function unloadPage(){1!=exitPageStatus&&doQuit()}function showDiv(a){if(!document.getElementsByTagName)return null;for(var b=document.getElementsByTagName("div"),c=0;c<b.length;c++){var d=b[c],e=d.id;("question"==e||"correct"==e||"incorrect"==e)&&(d.style.display="none"),e==a&&(d.style.display="block")}}function GoToPage(a){IntraNavigation=!0,window.location.replace(a)}function Previous(){doSetValue("adl.nav.request","previous"),doGetValue("adl.nav.request_valid.previous"),IntraNavigation=!0,doTerminate()}function Continue(){doSetValue("adl.nav.request","continue"),IntraNavigation=!0,doTerminate()}function PreviousQuiz(){doSetValue("adl.nav.request","previous"),doGetValue("adl.nav.request_valid.previous"),IntraNavigation=!0,doTerminate()}function ContinueQuiz(){doSetValue("adl.nav.request","continue"),IntraNavigation=!0,doTerminate()}function onUnexpectedExit(){0==IntraNavigation?doTerminate():IntraNavigation=!1}function Initialize(a){"resume"!=f&&doInitialize();for(var b=document.getElementsByTagName("img"),c=0;c<b.length;c++){var d=b[c],e=d.className;"prevBtn"==e&&RenderPreviousButton()&&(d.style.visibility="visible"),"singlepage"==a&&"nextBtn"==e&&RenderContinueButton()&&(d.style.visibility="visible")}var f=doGetValue("cmi.entry")}function SetContinue(){for(var a=document.getElementsByTagName("img"),b=0;b<a.length;b++){var c=a[b],d=c.className;"nextBtn"==d&&RenderContinueButton()&&(c.style.visibility="visible")}}function Terminate(){IntraNavigation||(doSetValue("cmi.completion_status","completed"),doSetValue("cmi.exit",""),doTerminate())}function RenderPreviousButton(){var a=doGetValue("adl.nav.request_valid.previous");return"true"==a?!0:!1}function RenderContinueButton(){var a=doGetValue("adl.nav.request_valid.continue");return"true"==a?!0:!1}var answer="",rawScore=0,exitPageStatus=!1,IntraNavigation=!1;