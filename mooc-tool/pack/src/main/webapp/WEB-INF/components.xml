<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd">
	<!-- <context:component-scan base-package="com.bysakai.byservice"/> 
		<context:annotation-config /> -->

	
	<!-- service -->
	<bean id="com.bysakai.mooc.api.CourseService"
    	class="com.bysakai.mooc.api.impl.CourseServiceImpl">
		<property name="siteService" ref="org.sakaiproject.site.api.SiteService" />
		<property name="moocDao" ref="com.bysakai.mooc.dao.MoocDao"/>
	</bean>
     <bean id="com.bysakai.mooc.api.RecItemService"
    	class="com.bysakai.mooc.api.impl.RecItemServiceImpl">
    	<property name="moocDao" ref="com.bysakai.mooc.dao.MoocDao"/>
	</bean>
        
    <bean id="com.bysakai.mooc.api.CategoryService"
    	class="com.bysakai.mooc.api.impl.CategoryServiceImpl">
    	<property name="moocDao" ref="com.bysakai.mooc.dao.MoocDao"/>
	</bean>
        
    <bean id="com.bysakai.mooc.api.TeacherService"
    	class="com.bysakai.mooc.api.impl.TeacherServiceImpl">
    	<property name="moocDao" ref="com.bysakai.mooc.dao.MoocDao"/>
	</bean>
        
        
    <!-- logic
	<bean id="com.bysakai.mooc.logic.TeacherLogic"
    	class="com.bysakai.mooc.logic.impl.TeacherLogicImpl">
    	<property name="dao" ref="com.bysakai.mooc.dao.MoocDao"/>
	</bean>
	<bean id="com.bysakai.mooc.logic.SpecialityLogic"
    	class="com.bysakai.mooc.logic.impl.SpecialityLogicImpl">
    	<property name="dao" ref="com.bysakai.mooc.dao.MoocDao"/>
	</bean>
	<bean id="com.bysakai.mooc.logic.RecItemLogic"
    	class="com.bysakai.mooc.logic.impl.RecItemLogicImpl">
    	<property name="dao" ref="com.bysakai.mooc.dao.MoocDao"/>
	</bean>
	 -->
	
	<!-- setup a DAO, accessed via the transaction proxy -->
	<bean id="com.bysakai.mooc.dao.MoocDaoTarget"
    	class="com.bysakai.mooc.dao.impl.MoocDaoImpl"
    	init-method="init">
		<property name="sessionFactory" ref="org.sakaiproject.springframework.orm.hibernate.GlobalSessionFactory" />
		<property name="persistentClasses">
         <list>
            <value>com.bysakai.mooc.model.Course</value>
            <value>com.bysakai.mooc.model.RecItem</value>
            <value>com.bysakai.mooc.model.Categorys</value>
            <value>com.bysakai.mooc.model.Teacher</value>
         </list>
      </property>
	</bean>
        
	<!--  register the DAO as a transactional interceptor. Use the classloader proxy from gendao because this is a protected DAO
-->
	 <bean id="com.bysakai.mooc.dao.MoocDao" class="org.sakaiproject.genericdao.springutil.CurrentClassLoaderTxProxyFactoryBean">
	      <property name="transactionManager" ref="org.sakaiproject.springframework.orm.hibernate.GlobalTransactionManager" />
	      <property name="target" ref="com.bysakai.mooc.dao.MoocDaoTarget" />
	      <property name="transactionAttributes">
	         <props>
	            <prop key="get*">PROPAGATION_REQUIRED,readOnly</prop>
	            <prop key="find*">PROPAGATION_REQUIRED,readOnly</prop>
	            <prop key="count*">PROPAGATION_REQUIRED,readOnly</prop>
	            <prop key="*">PROPAGATION_REQUIRED</prop>
	         </props>
	      </property>
	   </bean>
	
	<!-- Add our HBM files to the Sakai global session factory -->
	<bean id="com.bysakai.mooc.hbm.HBMMappingList"
    	class="org.sakaiproject.springframework.orm.hibernate.impl.AdditionalHibernateMappingsImpl">

	    <property name="mappingResources">
	      <list>
	     	<value>com/bysakai/mooc/model/hbm/Course.hbm.xml</value>
	      	<value>com/bysakai/mooc/model/hbm/Categorys.hbm.xml</value>
	        <value>com/bysakai/mooc/model/hbm/RecItem.hbm.xml</value>
	       	<value>com/bysakai/mooc/model/hbm/Teacher.hbm.xml</value>
	      </list>
	    </property>

  	</bean>
</beans>
